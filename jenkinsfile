node {
    try {
        def buildNum = env.BUILD_NUMBER 
        def branchName = env.BRANCH_NAME
        registry = "shadowlorddocker/pipeline"
        registryCredential = "dckr_pat_29bSbuWczhKyv9EE-kPc5gmicLk"
        echo "Build Number: ${buildNum}"
        echo "Branch Name: ${branchName}"

        stage('Atelier - clone') {
            git branch: 'DEV',
                        credentialsId: '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',
                        url: 'https://github.com/Dialsyp/Atelier.git'
        }

        stage('TEST') {
            sh "echo 'Hello-World ici je fait mes testes unitaire pour la partie DEV'"
        }

        stage('PACK') {
            sh "echo 'Hello-World ici je fait Mon packaging pour la partie DEV'"
        }
        stage('ANSIBLE - Deploy'){
            sh "echo 'Hello-World ici je fait Mon deployment pour la partie DEV'"
        }
    }
    finally {
        // cleanWs() is not needed here, as it was already called at the beginning
    }
}
