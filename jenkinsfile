node {
    try {
        def buildNum = env.BUILD_NUMBER 
        def branchName = env.BRANCH_NAME
        registry = "shadowlorddocker/pipeline"
        registryCredential = "dckr_pat_29bSbuWczhKyv9EE-kPc5gmicLk"
        echo "Build Number: ${buildNum}"
        echo "Branch Name: ${branchName}"

        stage('Atelier - clone') {
            git branch: 'DEV',
                        credentialsId: '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',
                        url: 'https://github.com/Dialsyp/Atelier.git'
        }

        stage('PremiereEtape') {
            sh " cd front &&  docker build -t DEV:$BUILD_NUMBER ."
        }

        stage('deuxiemeEtape') {
            sh "echo 'hello world'"
            docker.withRegistry( '', registryCredential ) {
            dockerImage.push()
        }
        }
    }
    finally {
        // cleanWs() is not needed here, as it was already called at the beginning
    }
}
